<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shower Arguments</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <div class="steam steam-1">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/>
                </svg>
            </div>
            <div class="steam steam-2">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/>
                </svg>
            </div>
            <div class="steam steam-3">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/>
                </svg>
            </div>
            <div class="header-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                </svg>
            </div>
            <h1>Shower Arguments</h1>
            <p class="tagline">The comeback you thought of 3 hours later</p>
        </header>

        <main>
            <section class="input-section">
                <h2>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    What happened?
                </h2>
                <textarea id="situation" placeholder="Someone said something dumb and I froze. They claimed that pineapple doesn't belong on pizza and looked at me like I was a monster. I just stood there. It's been 4 hours and I'm still thinking about it."></textarea>

                <div class="context-section">
                    <label for="context">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                        </svg>
                        What did they actually say? (optional)
                    </label>
                    <input type="text" id="context" placeholder="Their exact words, if you remember them">
                </div>

                <button id="generate-btn" onclick="generate()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
                    </svg>
                    Generate Comebacks
                </button>
            </section>

            <section id="results" class="results-section" style="display: none;">
                <div class="results-header">
                    <h2>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                        What you should have said:
                    </h2>
                    <span class="category-badge" id="category"></span>
                </div>

                <div id="comebacks" class="comebacks-list"></div>

                <div class="bonus-card" id="bonus-card">
                    <h3>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                            <path d="M2 17l10 5 10-5"/>
                            <path d="M2 12l10 5 10-5"/>
                        </svg>
                        Pro Tip
                    </h3>
                    <p id="bonus-advice"></p>
                </div>

                <button class="btn-secondary" onclick="generate()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="23 4 23 10 17 10"/>
                        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
                    </svg>
                    Try Again
                </button>
            </section>

            <section class="explanation">
                <h2>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                    </svg>
                    How it works
                </h2>
                <div class="how-grid">
                    <div class="how-step">
                        <span class="step-num">1</span>
                        <p>You describe the argument you should have won</p>
                    </div>
                    <div class="how-step">
                        <span class="step-num">2</span>
                        <p>Our algorithm analyzes the audacity</p>
                    </div>
                    <div class="how-step">
                        <span class="step-num">3</span>
                        <p>You get the devastating comeback you deserved</p>
                    </div>
                    <div class="how-step">
                        <span class="step-num">4</span>
                        <p>Peace of mind (hopefully)</p>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                </svg>
                For those 3 AM moments when you finally think of the perfect response.
            </p>
            <p class="disclaimer">Not responsible for ruined relationships. Use responsibly.</p>
        </footer>
    </div>

    <script>
        async function generate() {
            const situation = document.getElementById('situation').value;
            if (!situation.trim()) {
                alert('Tell us what happened!');
                return;
            }

            const context = document.getElementById('context').value;
            const btn = document.getElementById('generate-btn');

            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/></svg> Thinking...';
            btn.disabled = true;

            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ situation, context })
                });

                const data = await response.json();
                showResults(data);
            } catch (error) {
                alert('Failed to generate comebacks: ' + error.message);
            }

            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg> Generate Comebacks';
            btn.disabled = false;
        }

        function showResults(data) {
            document.getElementById('category').textContent = data.category;

            const comebacksList = document.getElementById('comebacks');
            comebacksList.innerHTML = '';

            data.comebacks.forEach((comeback, i) => {
                const card = document.createElement('div');
                card.className = 'comeback-card';
                card.style.animationDelay = `${i * 0.1}s`;
                card.innerHTML = `
                    <span class="comeback-num">${i + 1}</span>
                    <p class="comeback-text">"${comeback}"</p>
                    <button class="btn-copy" onclick="copyComeback(this, '${comeback.replace(/'/g, "\\'")}')">Copy</button>
                `;
                comebacksList.appendChild(card);
            });

            document.getElementById('bonus-advice').textContent = data.bonus_advice;
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function copyComeback(btn, text) {
            navigator.clipboard.writeText(text);
            btn.textContent = 'Copied!';
            setTimeout(() => {
                btn.textContent = 'Copy';
            }, 2000);
        }

        // Enter to submit
        document.getElementById('situation').addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.metaKey) {
                generate();
            }
        });
    </script>
</body>
</html>
